apiVersion: v1
kind: ConfigMap
metadata:
  name: litellm-config
  namespace: litellm
data:
  proxy_server_config.yaml: |
    model_list:
      - model_name: vllm-embed
        litellm_params:
          model: openai/Qwen/Qwen3-Embedding-0.6B
          api_key: "os.environ/VLLM_API_KEY"
          api_base: http://vllm-embed.vllm-embed.svc.cluster.local:8000/v1
        model_info:
          mode: embedding

    litellm_settings:
      callbacks: ["prometheus"]
      prometheus_initialize_budget_metrics: true
      require_auth_for_metrics_endpoint: false
      cache: true
      cache_params:
        type: qdrant-semantic
        qdrant_api_base: http://qdrant.qdrant.svc.cluster.local:6333
        qdrant_api_key: os.environ/QDRANT_API_KEY
        qdrant_semantic_cache_embedding_model: text-embedding-3-large
        qdrant_collection_name: litellm_semantic_cache
        qdrant_quantization_config: binary
        similarity_threshold: 0.8
        ttl: 600
        supported_call_types: ["acompletion", "atext_completion"]
      json_logs: true
      turn_off_message_logging: true
      redact_user_api_key_info: true
      enable_json_schema_validation: true
      set_verbose: true
      drop_params: true

    router_settings:
      routing_strategy: usage-based-routing-v2
      enable_pre_call_checks: false
      num_retries: 3
      retry_after: 1
      allowed_fails: 3
      cooldown_time: 30
      allowed_fails_policy:
        AuthenticationErrorAllowedFails: 3
        TimeoutErrorAllowedFails: 6
        RateLimitErrorAllowedFails: 10000
        ContentPolicyViolationErrorAllowedFails: 6
        InternalServerErrorAllowedFails: 10
        BadRequestErrorAllowedFails: 1000
      max_fallbacks: 3
      enable_tag_filtering: true
      cache_responses: true
      redis_host: redis.litellm.svc.kube.pc-tips.se
      redis_port: "6379"

    general_settings:
      store_model_in_db: true
      store_prompts_in_spend_logs: true
      enforce_user_param: false
      background_health_checks: false
      health_check_interval: 300
      health_check_details: true
      ui_access_mode: admin_only
      max_request_size_mb: 20
      max_response_size_mb: 25
      database_connection_pool_limit: 50
      database_connection_timeout: 60
      allow_requests_on_db_unavailable: false

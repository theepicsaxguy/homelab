apiVersion: v1
kind: ConfigMap
metadata:
  name: mastodon-extra-env
  namespace: mastodon
data:
  RAILS_ENV: "production"
  NODE_ENV: "production"
  TZ: "Europe/Stockholm"
  DB_HOST: "mastodon-postgresql-pooler"
  DB_PORT: "5432"
  DB_NAME: "mastodon"
  DB_SSLMODE: "verify-ca"
  DB_SSLROOTCERT: "/opt/mastodon/.postgresql/root.crt"
  REDIS_HOST: "mastodon-redis-master"
  REDIS_PORT: "6379"
  REDIS_URL: "redis://mastodon-redis-master:6379/0"
  SIDEKIQ_REDIS_URL: "redis://mastodon-redis-master:6379/1"
  CACHE_REDIS_URL: "redis://mastodon-redis-master:6379/2"
  ES_ENABLED: "false"
  ES_HOST: "mastodon-es"
  ES_PORT: "9200"
  ES_PRESET: "single_node_cluster"
  REPLICA_DB_HOST: "mastodon-postgresql-repl"
  REPLICA_DB_PORT: "5432"
  REPLICA_DB_NAME: "mastodon"
  REPLICA_PREPARED_STATEMENTS: "false"
  REPLICA_DB_TASKS: "false"
  MASTODON_PROMETHEUS_EXPORTER_ENABLED: "true"
  MASTODON_PROMETHEUS_EXPORTER_LOCAL: "true"
  SINGLE_USER_MODE: "false"
  RAILS_LOG_TO_STDOUT: "true"
  PREPARED_STATEMENTS: "false"
  DB_POOL: "10"
  FETCH_REPLIES_ENABLED: "true"
  IP_RETENTION_PERIOD: "15552000"
  MASTODON_USE_LIBVIPS: "true"
  DEFAULT_LOCALE: "en"
  FORCE_DEFAULT_LOCALE: "true"
  SMTP_DELIVERY_METHOD: "smtp"
  SMTP_AUTH_METHOD: "login"
  SMTP_SSL: "true"
  SMTP_TLS: "false"
  SMTP_ENABLE_STARTTLS_AUTO: "false"
  PORT: "3000"
  BIND: "0.0.0.0"
  RAILS_SERVE_STATIC_FILES: "true"
  WEB_CONCURRENCY: "2"
  MAX_THREADS: "5"
  STREAMING_API_BASE_URL: "wss://goingdark.social"
  STREAMING_PORT: "4000"
  SIDEKIQ_CONCURRENCY: "5"
  S3_ENABLED: "true"
  S3_BUCKET: "mastodata"
  S3_ALIAS_HOST: "cdn.goingdark.social"
  S3_PROTOCOL: "https"
  S3_REGION: "us-west-1"
  S3_PERMISSION: "public-read"
  EXTRA_MEDIA_HOSTS: "https://cdn.goingdark.social"

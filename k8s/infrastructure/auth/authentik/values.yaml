authentik:
  secret_key: ""  # Will be sourced from an existing K8s secret via extraSecretMounts (see below)
  error_reporting:
    enabled: true
  postgresql:
    password: ""  # Sourced from existing secret

server:
  ingress:
    enabled: false
  # Use extraSecretMounts to mount secrets as files per authentik chart documentation
  extraSecretMounts:
    - name: authentik-secrets
      secretName: authentik-combined-secret
      mountPath: /authentik-secrets
      readOnly: true
    - name: postgres-creds
      secretName: authentik-combined-secret
      mountPath: /postgres-creds
      readOnly: true
  extraEnv:
    - name: AUTHENTIK_SECRET_KEY
      valueFrom:
        secretKeyRef:
          name: authentik-combined-secret
          key: secret_key
    - name: AUTHENTIK_POSTGRESQL__PASSWORD
      valueFrom:
        secretKeyRef:
          name: authentik-combined-secret
          key: postgresql_password

postgresql:
  enabled: true
  auth:
    password: ""  # will be sourced in the same way

redis:
  enabled: true

worker:
  extraSecretMounts:
    - name: postgres-creds
      secretName: authentik-combined-secret
      mountPath: /postgres-creds
      readOnly: true
  extraEnv:
    - name: AUTHENTIK_POSTGRESQL__PASSWORD
      valueFrom:
        secretKeyRef:
          name: authentik-combined-secret
          key: postgresql_password
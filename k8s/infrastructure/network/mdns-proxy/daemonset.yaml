apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: mdns-repeater
  namespace: network-system
  labels:
    app: mdns-repeater
spec:
  selector:
    matchLabels:
      app: mdns-repeater
  template:
    metadata:
      labels:
        app: mdns-repeater
    spec:
      hostNetwork: false
      containers:
      - name: mdns-repeater
        image: hachiyuki/mdns-repeater:latest
        args:
        - --iface=eth0 # This should be the primary interface of your nodes
        ports:
        - containerPort: 5353
          hostPort: 5353
          protocol: UDP
        - containerPort: 1900
          hostPort: 1900
          protocol: UDP
        securityContext:
          capabilities:
            add: ["NET_RAW", "NET_BIND_SERVICE"]
          privileged: false
      terminationGracePeriodSeconds: 2
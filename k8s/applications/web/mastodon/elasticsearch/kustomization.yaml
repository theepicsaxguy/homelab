apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
- deployment.yaml
- es-cert.yaml
- externalsecret.yaml
- httproute-es.yaml
- kibana.yml
- networkpolicy.yaml
- pvc-es.yaml
- service.yaml
- serviceaccount.yaml
- statefulset.yaml

namespace: mastodon

patches:
- target:
    group: batch
    version: v1
    kind: Job
    name: elasticsearch-setup-mastodon-user
  patch: |-
    - op: replace
      path: /metadata/name
      value: elasticsearch-setup-mastodon-user

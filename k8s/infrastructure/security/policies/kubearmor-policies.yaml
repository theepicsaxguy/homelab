apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: minecraft-lsm-policy
  namespace: minecraft
spec:
  severity: medium
  selector:
    matchLabels:
      app.kubernetes.io/name: minecraft
  file:
    matchPaths:
      - path: /etc/passwd
        readOnly: false
        recursive: true
        action: Block
      - path: /etc/shadow
        readOnly: false
        recursive: true
        action: Block
      - path: /root/.ssh
        readOnly: false
        recursive: true
        action: Block
  network:
    matchEgress: []
    action: Audit
  process:
    matchPaths:
      - path: /bin/bash
      - path: /bin/sh
      - path: /bin/zsh
      - path: /usr/bin/sudo
      - path: /usr/bin/su
    action: Block
---
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: ai-workload-lsm-policy
  namespace: ai
spec:
  severity: high
  selector:
    matchLabels:
      app.kubernetes.io/part-of: ai
  file:
    matchPaths:
      - path: /models
        readOnly: true
        recursive: true
        action: Block
      - path: /app/data
        readOnly: false
        recursive: true
        action: Audit
  network:
    matchEgress:
      - protocol: TCP
        ports: ["80", "443", "8000"]
    matchIngress:
      - protocol: TCP
        ports: ["80", "443", "8000"]
    action: Audit
  process:
    matchPaths:
      - path: /bin/netcat
      - path: /bin/nc
      - path: /bin/curl
      - path: /usr/bin/wget
    action: Block
---
apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: media-service-lsm-policy
  namespace: media
spec:
  severity: medium
  selector:
    matchLabels:
      app.kubernetes.io/part-of: media
  file:
    matchDirectories:
      - dir: /config
        readOnly: true
        recursive: true
      - dir: /media
        readOnly: true
        recursive: true
    action: Audit
  network:
    matchEgress:
      - protocol: TCP
        ports: ["8096", "8920"]
    action: Audit
  process:
    matchPaths:
      - path: /bin/chmod
      - path: /bin/chown
    action: Block

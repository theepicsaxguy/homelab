apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: portkey-provider-secrets
  namespace: portkey
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: bitwarden-backend
    kind: ClusterSecretStore
  target:
    name: portkey-provider-secrets
    creationPolicy: Owner
    template:
      type: Opaque
      data:
        # Azure OpenAI credentials
        AZURE_OPENAI_API_KEY: "{{ .azure_openai_api_key }}"
        AZURE_OPENAI_API_BASE: "{{ .azure_openai_api_base }}"
        AZURE_OPENAI_API_VERSION: "{{ .azure_openai_api_version }}"
        
        # Anthropic credentials  
        ANTHROPIC_API_KEY: "{{ .anthropic_api_key }}"
        
        # OpenAI credentials
        OPENAI_API_KEY: "{{ .openai_api_key }}"
        
        # HuggingFace/Cerebras credentials
        HUGGINGFACE_API_KEY: "{{ .huggingface_api_key }}"
        CEREBRAS_API_BASE: "{{ .cerebras_api_base }}"
  data:
    - secretKey: azure_openai_api_key
      remoteRef:
        key: portkey-azure-openai-api-key
    - secretKey: azure_openai_api_base  
      remoteRef:
        key: portkey-azure-openai-api-base
    - secretKey: azure_openai_api_version
      remoteRef:
        key: portkey-azure-openai-api-version
    - secretKey: anthropic_api_key
      remoteRef:
        key: portkey-anthropic-api-key
    - secretKey: openai_api_key
      remoteRef:
        key: portkey-openai-api-key
    - secretKey: huggingface_api_key
      remoteRef:
        key: portkey-huggingface-api-key
    - secretKey: cerebras_api_base
      remoteRef:
        key: portkey-cerebras-api-base

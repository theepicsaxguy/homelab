apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: falco-system

resources:
- ns.yaml

helmCharts:
- name: falco
  includeCRDs: true
  namespace: falco-system
  releaseName: falco
  repo: https://falcosecurity.github.io/charts
  version: 4.4.2  # renovate: datasource=helm registryUrl=https://falcosecurity.github.io/charts

patches:
- target:
    kind: DaemonSet
    name: falco
  patch: |-
    - op: add
      path: /spec/template/spec/tolerations
      value:
        - key: node-role.kubernetes.io/control-plane
          operator: Exists
          effect: NoSchedule

patchesStrategicMerge:
- values.yaml

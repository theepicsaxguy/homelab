# Website (website/) - Agent Guidelines

This `AGENTS.md` describes how to work with the Docusaurus documentation site in `website/`.

## Purpose & Scope

- Scope: `website/` (docs, site config, static assets, and build outputs).
- Goal: enable agents to build, lint, and test documentation changes and static site updates.

## Quick-start Commands

Run these commands from the `website/` directory.

```bash
# Install dependencies
npm install

# Start dev server (hot reload)
npm start

# Type check and build
npm run typecheck
npm run build

# Lint docs and markdown with Vale (configured in repo)
npm run lint:all
```

Notes:
- Node and npm version expectations may be in `package.json` engines field.
- The built site outputs to `website/build/` — do not commit build artifacts.

## Structure & Examples

- Key files: `docusaurus.config.ts`, `sidebars.ts`, `tsconfig.json`, `docs/` (content).
- Blog and docs live under `website/docs/` and `website/blog/` respectively.

## Tests & Validation

- Local: `npm start` to visually inspect pages; `npm run typecheck` to ensure TS correctness.
- CI: `website-build.yaml` workflow performs a production build and link-checks. Ensure PRs update docs without breaking the build.

## How to Make Docs Changes

1. Edit or add `.md`/`.mdx` files under `website/docs/`.
2. Run `npm run lint:all` and `npm run typecheck` locally.
3. Open a PR. Include a brief summary of changes and the pages affected.

## Code Style & Patterns

- Use MDX format for interactive documentation components
- Follow naming: kebab-case for files and directories (e.g., `getting-started.md`)
- Use frontmatter for page metadata (title, description, sidebar position)
- Reference existing docs for patterns: `website/docs/` structure
- Use relative links for internal navigation: `[text](../other-page.md)`
- Include code blocks with language tags for syntax highlighting
- Use Docusaurus components (Admonitions, Tabs) for rich content

## Documentation Writing Standards

### Voice and Tense

**DO:**
- Use imperative voice for instructions: "Configure the setting", "Run the command"
- Use declarative/present tense for facts: "The system uses X", "Kopia uploads data to S3"
- State what exists and how it works, not how it was created or what changed

**DON'T:**
- ❌ First-person plural: "We use", "We investigated", "We discovered"
- ❌ Temporal/narrative language: "Now uses", "Has been updated to", "Recently changed"
- ❌ Journey/story telling: "We explored X and found that...", "After investigating..."
- ❌ Status updates: "The system now supports...", "This has been migrated to..."

### Examples

**Bad (blog/narrative style):**
```markdown
We investigated using CSI snapshots but discovered they were experimental.
After testing, we decided to use Kopia instead because it's superior for our use case.
```

**Good (technical documentation):**
```markdown
The system uses Kopia filesystem backups instead of CSI snapshots.

**Rationale:**
- CSI snapshot feature is experimental in Proxmox CSI driver
- Requires root-level credentials
- Kopia provides incremental deduplication
- True disaster recovery with all data in S3
```

### Structure for Decision Documentation

When documenting technical decisions, use this structure:

1. **What is implemented** (declarative statement)
2. **Why this approach** (rationale section, still factual)
3. **How it works** (technical details)

Don't write a chronological story of the decision-making process.

### Comments in Code

**Configuration files (YAML/HCL):**

- State what the setting does, not why you chose it

**Bad:** `# We use Kopia because snapshots didn't work`
**Good:** `# Kopia filesystem backup to S3`

**When comparison is relevant:**

**Bad:** `# without needing CSI snapshots`
**Good:** `# instead of CSI snapshots`

### Removed/Deprecated Features

**Don't say:**
- "We removed X because..."
- "This is no longer used..."
- "Previously we used X but now..."

**Do say** (if context is needed):
- "CSI snapshots are not enabled. Kopia filesystem backups are used."
- In a rationale section: "CSI snapshots require experimental features"

### Changelog vs Documentation

- **CHANGELOG.md:** Auto-generated by release-please. Do not edit manually.
- **PR descriptions:** Can use temporal language ("Changed from X to Y", "Now uses")
- **Documentation:** Timeless facts only ("Uses X", "Configured with Y")

## Boundaries

- Do not commit `website/build/` or other generated output.
- Do not add large binary assets to the repo; use external storage and reference by URL.

## Pre-Merge Checklist

Before merging documentation changes, verify:

- [ ] Site builds successfully: `npm run build` passes
- [ ] TypeScript type checking passes: `npm run typecheck`
- [ ] Markdown linting passes: `npm run lint:all`
- [ ] Local dev server shows changes correctly: `npm start`
- [ ] Internal links work and don't create 404s
- [ ] Code examples are tested and accurate
- [ ] Images are optimized and appropriately sized
- [ ] Frontmatter includes title and description
- [ ] Changes don't break existing navigation/sidebar
- [ ] No build artifacts committed (`website/build/`, `node_modules/`)

---

